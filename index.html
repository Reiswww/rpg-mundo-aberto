<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>RPG Mundo Aberto</title>

<style>
body {
  margin: 0;
  background: black;
  color: white;
  font-family: monospace;
  text-align: center;
}

#start, #intro {
  height: 100vh;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
}

#game {
  display: none;
}

button {
  padding: 10px 20px;
  font-size: 18px;
}

canvas {
  image-rendering: pixelated;
  border: 3px solid white;
  background: #2e7d32;
}

#controls button {
  width: 60px;
  height: 60px;
  font-size: 22px;
}
</style>
</head>

<body>

<div id="start">
  <h1>RPG Mundo Aberto</h1>
  <button onclick="start()">START</button>
</div>

<div id="intro" style="display:none;">
  <p id="text"></p>
</div>

<div id="game">
  <canvas id="map" width="320" height="320"></canvas>
  <div id="controls">
    <button onclick="move(0,-1)">↑</button><br>
    <button onclick="move(-1,0)">←</button>
    <button onclick="move(1,0)">→</button><br>
    <button onclick="move(0,1)">↓</button>
  </div>
</div>

<script>
const story = "Você acorda em um mundo desconhecido...\nUma nova jornada começa.";
let i = 0;

function start() {
  document.getElementById("start").style.display = "none";
  document.getElementById("intro").style.display = "flex";
  typeText();
}

function typeText() {
  if (i < story.length) {
    document.getElementById("text").textContent += story[i];
    i++;
    setTimeout(typeText, 50);
  } else {
    setTimeout(() => {
      document.getElementById("intro").style.display = "none";
      document.getElementById("game").style.display = "block";
      draw();
    }, 1200);
  }
}

const canvas = document.getElementById("map");
const ctx = canvas.getContext("2d");

const tile = 32;

const map = [
  [1,1,1,1,1,1,1,1,1,1],
  [1,0,0,0,0,0,0,0,0,1],
  [1,0,0,1,1,1,0,0,0,1],
  [1,0,0,0,0,1,0,0,0,1],
  [1,0,0,0,0,0,0,0,0,1],
  [1,1,1,1,1,1,1,1,1,1]
];

let player = { x: 1, y: 1 };

function draw() {
  ctx.clearRect(0,0,320,320);

  for (let y=0; y<map.length; y++) {
    for (let x=0; x<map[y].length; x++) {
      ctx.fillStyle = map[y][x] === 1 ? "#1b5e20" : "#66bb6a";
      ctx.fillRect(x*tile, y*tile, tile, tile);
    }
  }

  ctx.fillStyle = "red";
  ctx.fillRect(player.x*tile+8, player.y*tile+8, 16, 16);
}

function move(dx,dy) {
  let nx = player.x + dx;
  let ny = player.y + dy;

  if (map[ny][nx] === 0) {
    player.x = nx;
    player.y = ny;
  }
  draw();
}
</script>

</body>
</html>
